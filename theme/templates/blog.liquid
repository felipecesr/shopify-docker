<!-- /templates/blog.liquid -->

{% include 'breadcrumb' %}

<section class="blog blog-index">

{% comment %}

  Loop through a defined number of articles with the 'paginate' tag.
  Don't forget to close the tag after your loop.

{% endcomment %}

{% paginate blog.articles by 8 %}

{% comment %}
  This template is also used for listing out articles of a specific tag.
  You can change layouts or styles by checking if current_tags is true.
{% endcomment %}

  <div class="grid">

    <div class="grid__item">
      <header class="blog-header">
      {% if current_tags %}
        <h1 class="standard-index">{{ blog.title }}:&nbsp;{{ current_tags.first }}</h1>
      {% else %}
        <h1 class="standard-index">{{ blog.title }}</h1>
      {% endif %}
      </header>
    </div>

    <div class="grid__item large--three-quarters">
      {% comment %}
        Loop through each article in your blog. This is limited to what you set for pagination above.

        For more info on article liquid tags:
          - http://docs.shopify.com/themes/liquid-variables/article
      {% endcomment %}

        {% for article in blog.articles %}

        {% capture author %}{{ article.author }}{% endcapture %}
        {% capture date %}<time datetime="{{ article.published_at | date: '%Y-%m-%d' }}">{{ article.published_at | date: format: 'month_day_year' }}</time>{% endcapture %}

        <div class="grid article-item">

          <div class="grid__item large--one-quarter desktop-down--hide article-meta">


           <p class="date">{{ date }}</p>
           <p class="author">{{ 'blogs.article.by_author' | t: author: author }}</p>


           {% include 'tags-article' %}

           {% if blog.comments_enabled? %}
           <p class="comments-link">
             <a href="{{ article.url }}#Comments">
                {{ 'blogs.comments.comments_with_count' | t: count: article.comments_count }}
              </a>
           </p>
           {% endif %}

          </div>

          <div class="grid__item large--three-quarters article-content">

            <h3 class="standard-single"><a href="{{ article.url }}">{{ article.title }}</a></h3>

            <div class="subtitle desktop-down--show">
              <p>{{ date }}<span aria-hidden="true">&nbsp;/&nbsp;</span>{{ 'blogs.article.by_author' | t: author: author }}</p>
            </div>

            {% if article.image %}
            <a href="{{ article.url }}">
              {% capture img_id %}ArticleImage-{{ article.image.id }}{% endcapture %}
              {% capture wrapper_id %}ArticleImage-Wrapper-{{ article.image.id }}{% endcapture %}
              {%- assign img_url = article.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
              <div id="{{ wrapper_id }}" class="resp-img-wrapper  article-image-wrapper js">
                <div style="padding-top:{{ 1 | divided_by: article.image.aspect_ratio | times: 100}}%;">
                  <img id="{{ img_id }}"
                       class="resp-img lazyload feature-image"
                       data-src="{{ img_url }}"
                       data-widths="[180, 360, 470, 600, 750, 940, 1080, 1296, 1512, 1728, 2048]"
                       data-aspectratio="{{ article.image.aspect_ratio }}"
                       data-sizes="auto"
                       alt="{{ article.image.alt | escape }}">
                </div>
              </div>
              <noscript>
                <img src="{{ article.image.src | img_url: 'large' }}" alt="{{ article.image.alt | escape }}" class="feature-image">
              </noscript>
            </a>
            {% endif %}

            <div class="rte feature-copy">
              {{ article.excerpt_or_content }}
            </div>

            <p><a href="{{ article.url }}" class="read-more feature-copy">{{ 'blogs.article.read_more' | t }} <span class="next-arrow">{% include 'icon-forward' %}</span></a></p>

            <div class="meta desktop-down--show">
             {% include 'tags-article', inline_class: 'inline-list' %}

             {% if blog.comments_enabled? %}
             <p class="comments-link">
               <a href="{{ article.url }}#Comments">
                  {{ 'blogs.comments.comments_with_count' | t: count: article.comments_count }}
                </a>
             </p>
             {% endif %}
            </div>

          </div>

          {% unless forloop.last %}
          <div class="grid__item">
            <hr>
          </div>
          {% endunless %}

        </div>

      {% endfor %}

      {% if paginate.pages > 1 %}
        <div class="pagination secondary grid--table">
          <div class="grid__item one-quarter text-left">
            {% if paginate.previous.is_link %}
              <a href="{{ paginate.previous.url }}" class="previous-paginate">
                 <span class="prev-arrow">{% include 'icon-back' %}</span>
                {{ paginate.previous.title | replace: '&laquo;', '' }}
              </a>
          {% endif %}
          </div>

          <div class="grid__item one-quarter text-right">
            {% if paginate.next.is_link %}
                <a href="{{ paginate.next.url }}">{{ paginate.next.title | replace: '&raquo;', '' }}
                   <span class="next-arrow">{% include 'icon-forward' %}</span>
                </a>
            {% endif %}
          </div>

        </div>
      {% endif %}

    </div>

    <div class="grid__item large--one-quarter blog-sidebar">
      {% include 'blog-sidebar' %}
    </div>

  </div>

{% endpaginate %}
</section>
